@page "/"

<div class="card" style="width:min(92vw, 460px)">
    <div style="text-align:center; margin-bottom:16px;">
        <img src="img/logo.png" alt="Ding" style="height:48px; margin-bottom:8px;" />
        <h2 style="color:var(--brand-teal); margin:0; font-size:26px;">Welcome to Ding</h2>
        <p style="color:#5b6b75; margin-top:6px;">Select your country and enter a mobile number</p>
    </div>

    <div class="input" style="margin-bottom:10px;">
        <span style="color:var(--brand-teal); font-weight:600;">🌍</span>
        <select class="flex-1" @bind="CountryIso" @bind:event="oninput">
            <option value="USA">United States (+1)</option>
            <option value="UK">United Kingdom (+44)</option>
            <option value="IN">India (+91)</option>
            <option value="BD">Bangladesh (+880)</option>
        </select>
    </div>

    <div class="input" style="margin-bottom:16px;">
        <span style="color:var(--brand-teal); font-weight:600;">📞</span>
        <input class="flex-1" type="tel" placeholder="Mobile Number"
               @bind="AccountNumber" @bind:event="oninput" onchange="DetectCountry" />
    </div>

    <button class="brand-btn" disabled="@(!IsValid)">Next</button>

    <div style="display:flex; justify-content:center; opacity:.9; margin-top:18px;">
        <img src="img/bg.png" alt="people" style="max-width:100%; height:auto;" />
    </div>
</div>

@code {
    private string CountryIso { get; set; } = "BD";
    private string? AccountNumber { get; set; }

    bool IsValid => !string.IsNullOrWhiteSpace(AccountNumber) && AccountNumber.Length >= 8;

    private void DetectCountry(ChangeEventArgs e)
    {
        var input = e.Value?.ToString() ?? string.Empty;

        if (input.StartsWith("+44"))
            CountryIso = "UK";
        else if (input.StartsWith("+91"))
            CountryIso = "IN";
        else if (input.StartsWith("+880"))
            CountryIso = "BD";
        else if (input.StartsWith("+1"))
            CountryIso = "USA";
    }
}
